[gd_scene load_steps=13 format=3 uid="uid://8tmgt00yc6a3"]

[ext_resource type="Script" uid="uid://1crl7nopt4jt" path="res://scripts/level.gd" id="1_2r41h"]
[ext_resource type="Texture2D" uid="uid://3btsldktxokk" path="res://assets/city.png" id="1_ppgk2"]
[ext_resource type="Texture2D" uid="uid://0boxs1e5f3qk" path="res://assets/mytrack2d.png" id="1_w8frs"]
[ext_resource type="Texture2D" uid="uid://sva8u1qa4mas" path="res://assets/finishline.png" id="2_mx8sn"]
[ext_resource type="Texture2D" uid="uid://qfx32rf4qak" path="res://assets/icons/coincollection.png" id="2_olg7q"]
[ext_resource type="Texture2D" uid="uid://cim6wace7el8x" path="res://assets/icons/chequered-flag.png" id="3_t1rx8"]
[ext_resource type="PackedScene" uid="uid://bibnqau26hlak" path="res://scenes/player.tscn" id="3_w8frs"]
[ext_resource type="Script" uid="uid://qd6s2vg7u1ji" path="res://scripts/player.gd" id="4_mx8sn"]
[ext_resource type="Script" uid="uid://d3kbxoj0x7nyi" path="res://scripts/crash.gd" id="7_klq6b"]
[ext_resource type="Script" uid="uid://b0yk0m4ysexfa" path="res://scripts/coin_area.gd" id="8_8c41q"]
[ext_resource type="PackedScene" uid="uid://dqh8uiruxcj5m" path="res://scenes/coin_instance.tscn" id="8_b121j"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_8c41q"]
size = Vector2(359.824, 49.998047)

[node name="Level" type="Node2D"]
script = ExtResource("1_2r41h")

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="ScoreMargin" type="MarginContainer" parent="CanvasLayer"]
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -71.0
offset_right = 71.0
offset_bottom = 40.0
grow_horizontal = 2
theme_override_constants/margin_top = 4

[node name="Label" type="Label" parent="CanvasLayer/ScoreMargin"]
layout_mode = 2
size_flags_horizontal = 4
text = "0000"

[node name="HealthMargin" type="MarginContainer" parent="CanvasLayer"]
offset_right = 40.0
offset_bottom = 40.0

[node name="CoinsMargin" type="MarginContainer" parent="CanvasLayer"]
anchors_preset = 2
anchor_top = 1.0
anchor_bottom = 1.0
offset_left = 19.0
offset_top = -71.0
offset_right = 106.0
offset_bottom = -24.0
grow_vertical = 0
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_constants/margin_left = 12
theme_override_constants/margin_top = 12
theme_override_constants/margin_right = 12
theme_override_constants/margin_bottom = 12

[node name="HBoxContainer" type="HBoxContainer" parent="CanvasLayer/CoinsMargin"]
layout_mode = 2

[node name="TextureRect" type="TextureRect" parent="CanvasLayer/CoinsMargin/HBoxContainer"]
clip_contents = true
layout_mode = 2
texture = ExtResource("2_olg7q")
expand_mode = 3

[node name="Label" type="Label" parent="CanvasLayer/CoinsMargin/HBoxContainer"]
layout_mode = 2
text = "0"

[node name="LapsMargin" type="MarginContainer" parent="CanvasLayer"]
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -152.0
offset_top = 3.0000005
offset_right = -76.0
offset_bottom = 50.0
grow_horizontal = 0
scale = Vector2(1.7253048, 1.7479463)
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_constants/margin_left = 12
theme_override_constants/margin_top = 12
theme_override_constants/margin_right = 12
theme_override_constants/margin_bottom = 12

[node name="HBoxContainer" type="HBoxContainer" parent="CanvasLayer/LapsMargin"]
layout_mode = 2

[node name="TextureRect" type="TextureRect" parent="CanvasLayer/LapsMargin/HBoxContainer"]
clip_contents = true
layout_mode = 2
texture = ExtResource("3_t1rx8")
expand_mode = 3

[node name="Label" type="Label" parent="CanvasLayer/LapsMargin/HBoxContainer"]
layout_mode = 2
text = "0/2"

[node name="city" type="Sprite2D" parent="."]
position = Vector2(134, 215)
scale = Vector2(11.952711, 9.87956)
texture = ExtResource("1_ppgk2")

[node name="Circuit" type="Area2D" parent="."]
position = Vector2(170.00002, -668)
rotation = 1.579224
scale = Vector2(1.6893996, 1.6216831)
collision_mask = 16

[node name="Track" type="Sprite2D" parent="Circuit"]
position = Vector2(723, 135)
scale = Vector2(2.6081083, 2.541587)
texture = ExtResource("1_w8frs")

[node name="OutterTrackLimit" type="CollisionPolygon2D" parent="Circuit"]
position = Vector2(723, 135)
scale = Vector2(2.8, 2.729)
polygon = PackedVector2Array(-176.40161, -40.65625, -190.55957, -59.411697, -201.67874, -83.80591, -202.06216, -110.95429, -194.77719, -134.16814, -180.97409, -153.44743, -162.95334, -160.13617, -136.49739, -162.49689, -113.875626, -164.85762, -75.91708, -164.85762, 181.7409, -186.10422, 208.19687, -180.2024, 228.90152, -170.75948, 244.62177, -156.20163, 255.35751, -139.28308, 265.32642, -116.46269, 262.48938, -81.74575, 255.35751, -63.346268, 244.62177, -50.36226, 235.41968, -41.706245, 212.41449, -32.65678, 177.52332, -23.607296, 284.8808, 5.114914, 293.69946, 3.541069, 310.18652, 14.164351, 317.85492, 36.197826, 317.4715, 80.264786, 302.90155, 104.65899, 287.18134, 112.52808, 266.8601, 119.610275, 128.44559, 118.42992, 126.528496, 134.95502, 118.47668, 146.36523, 106.797424, 157.96414, 91.25389, 162.89034, 79.75131, 161.31653, -265.7098, 161.31653, -291.78235, 155.80817, -310.56992, 134.16814, -319.00516, 108.59357, -311.72018, 78.29754, -289.48184, 60.19861, -258.0414, 42.099678, -257.65802, 33.837124, -252.67355, 3.1476393, -240.78754, -9.049464, -221.23315, -20.853115, -101.565216, -19.416065, -172.59637, -41.10817, -170.69374, -44.72352, -82.96182, -19.642027, -77.25397, -15.122838, -92.686325, -14.896878, -220.08289, -15.344745, -230.05179, -11.410195, -241.9378, -3.1476412, -249.22278, 6.688733, -252.29013, 14.557832, -252.67355, 21.246567, -253.82382, 29.902575, -250.75644, 39.738945, -257.27457, 46.821136, -267.2435, 51.93605, -287.56473, 64.92007, -294.78687, 76.16478, -298.16928, 85.429115, -297.7465, 99.4386, -294.36404, 117.06344, -288.02197, 130.621, -278.72028, 141.46704, -268.78436, 146.21219, -259.5751, 156.59506, 89.33679, 159.74269, 99.68912, 158.16887, 113.1088, 148.3325, 123.84455, 134.1681, 125.37823, 120.397194, 128.44559, 114.888824, 264.943, 111.7412, 281.9184, 100.568375, 295.65955, 91.07807, 302.00162, 73.00132, 301.156, 32.78054, 303.69284, 17.189342, 294.0829, 8.262528, 278.36267, 6.688732, 174.45596, -19.279293, 170.23834, -24.000751, 172.92227, -28.72221, 199.37823, -33.443672, 219.14073, -39.77226, 230.26158, -44.382065, 249.09895, -62.82129, 245.76862, -81.32896, 245.76862, -105.506615, 240.90637, -132.16983, 228.22223, -148.43892, 215.32669, -161.99648, 204.12238, -167.19354, 193.55228, -174.87617, 182.34796, -174.87617, 165.43579, -172.39061, -156.107, -150.02061, -164.77449, -150.6985, -171.53937, -146.40526, -181.47527, -134.65536, -186.12611, -129.91022, -189.93137, -118.61225, -189.50854, -106.18448, -191.19977, -96.46822, -190.98836, -83.8145, -190.55957, -72.78917, -187.1088, -64.133156, -179.4404, -56.26406, -172.80777, -45.175438)

[node name="InnerTrackLimit" type="CollisionPolygon2D" parent="Circuit"]
polygon = PackedVector2Array(55.641052, 406.9846, 71.03113, 408.21786, 880.19434, 398.35153, 925.7727, 337.9205, 1001, 296, 1320.5875, 281.80594, 1357.2869, 279.956, 1343.6726, 264.53992, 916.8938, 170.19351, 884.3378, 133.81157, 870.1316, 51.181362, 899.7279, -22.199188, 964.24786, -48.714867, 1185.0364, -77.08045, 1220.552, -86.3301, 1243.0452, -98.04635, 1254.2917, -124.562004, 1234.7582, -164.6438, 1206.9377, -183.75977, 377.64893, -136.27817, 368.17813, -123.32867, 389.48746, -103.59609, 417.89993, -88.79664, 615.60333, -38.23191, 694.32947, -24.04911, 720.37427, 61.664307, 714.45496, 141.21129, 673.61206, 213.35855, 620.33875, 233.7078, 220.19656, 245.42404, 202.43878, 306.47174, 170.47476, 347.1702, 84.64545, 381.08554, 57.41684, 392.18515, 49.7218, 398.3516, 48.537933, 400.2015, 48.537933, 395.26837, 55.049133, 389.10193, 69.84729, 381.08554, 89.38086, 373.06918, 115.4256, 363.20288, 146.2058, 350.25342, 168.69899, 341.00375, 188.23256, 302.15524, 198.8872, 283.03928, 204.21455, 252.20712, 207.17418, 243.57413, 212.50153, 234.32446, 224.93198, 232.47452, 594.29395, 228.77466, 604.3567, 228.158, 620.33875, 231.85786, 645.79156, 216.44179, 662.9574, 208.42542, 678.34753, 193.00934, 691.9618, 162.79381, 701.4326, 136.89479, 704.9842, 114.69563, 702.02454, 85.096756, 699.06494, 56.114517, 691.3699, 24.049065, 680.1233, -8.016388, 656.4462, -22.19918, 611.45984, -34.53205, 438.02542, -71.53063, 392.4471, -88.18, 377.64893, -105.44602, 367.58618, -111.61245, 362.85077, -117.16224, 360.4831, -125.79525, 365.81042, -133.81161, 374.6893, -141.82797, 1206.3457, -194.85934, 1225.8794, -187.45963, 1238.9016, -172.04352, 1246.5967, -159.09402, 1260.2109, -134.42828, 1260.803, -119.012215, 1259.0271, -104.829414, 1251.3322, -87.56341, 1230.0227, -77.08045, 1197.4668, -69.064095, 963.064, -38.231926, 923.40497, -12.332901, 900.3198, 22.815773, 889.66516, 59.81437, 897.3602, 90.64653, 905.6472, 111.612404, 911.56647, 139.36136, 935.2435, 153.54416, 961.8802, 172.04346, 1350.7758, 258.3735, 1360.8385, 265.77322, 1370.3093, 275.6395, 1370.3093, 287.97238, 1327.0986, 293.52216, 1005.0908, 304.62177, 969.57526, 319.4212, 949.4497, 331.13742, 932.2839, 344.0869, 922.81305, 355.80316, 913.3422, 372.4525, 907.423, 383.5521, 896.7683, 390.33517, 883.154, 403.9013, 72.215, 411.30106, 59.784546, 410.68445, 50.90564, 405.13467, 49.129852, 400.81818, 50.90564, 397.11832)

[node name="FinishLineArea" type="Area2D" parent="."]
collision_layer = 32
collision_mask = 16

[node name="FinishLine" type="Sprite2D" parent="FinishLineArea"]
position = Vector2(-619.4329, 604.3186)
rotation = -3.133165
scale = Vector2(0.47033647, 0.5515153)
texture = ExtResource("2_mx8sn")

[node name="FinishLineCollision" type="CollisionShape2D" parent="FinishLineArea"]
position = Vector2(-619.5, 604.5)
rotation = -3.133165
scale = Vector2(0.4703364, 0.55151534)
shape = SubResource("RectangleShape2D_8c41q")
one_way_collision = true
one_way_collision_margin = 0.1

[node name="Player" parent="." instance=ExtResource("3_w8frs")]
position = Vector2(-606, 725)
rotation = -1.5707964
collision_mask = 0
script = ExtResource("4_mx8sn")

[node name="Crash" type="Area2D" parent="."]
visible = false
collision_layer = 2
collision_mask = 16
script = ExtResource("7_klq6b")

[node name="MajorCrash" type="CollisionPolygon2D" parent="Crash"]
position = Vector2(170.00002, -668)
rotation = 1.5707964
scale = Vector2(1.6893996, 1.6216831)
polygon = PackedVector2Array(166.9232, 80.78027, 466.4379, 88.17998, 247.42517, 12.949509, 207.17418, -41.93174, 187.6406, -135.66153, 207.17416, -201.64236, 237.36241, -248.50726, 304.25006, -278.72278, 345.6849, -281.18936, 422.6353, -287.3558, 609.684, -289.8224, 1201.6104, -341.00378, 1282.1123, -321.88785, 1357.2869, -276.25626, 1389.251, -220.75836, 1413.52, -162.17728, 1409.3765, -88.796684, 1382.7397, -19.115997, 1341.3049, 26.51561, 1302.8297, 45.631554, 1185.6283, 77.08037, 1463.2417, 146.76105, 1489.8784, 144.29448, 1530.1294, 168.34357, 1553.2145, 230.62454, 1553.2145, 336.6872, 1511.7797, 397.73486, 1467.9772, 420.55066, 1405.825, 444.59976, 1057.7722, 437.20007, 1045.9337, 491.46466, 1006.27466, 527.8466, 956.55286, 550.6624, 15.390106, 546.346, -39.06711, 529.69666, -85.237366, 476.66528, -110.690216, 410.68445, -102.40326, 363.81958, -82.27777, 323.73773, -42.618713, 294.13885, 46.762177, 241.72418, 65.7038, 135.66153, -235.58667, 120.86211, -235.58667, 796.7031, 1679.8867, 782.52026, 1664.4967, -519.21375, -221.38043, -511.19733, -235.58667, 121.47875, 65.11188, 135.04489)

[node name="MajroCrash1" type="CollisionPolygon2D" parent="Crash"]
polygon = PackedVector2Array(-501, -566, -477, -592, -454, -569, -373, -396, -306, -346, -206, -334, -196, 342, -165, 420, -119, 462, -78, 491, 28, 502, 148, 450, 202, 352, 294, 23, 334, -43, 362, -72, 395, -77, 484, 1361, 451, 1413, 407, 1456, 341, 1468, 303, 1427, 277, 1350, 227, 963, 177, 872, 70, 832, -39, 865, -111, 935, -247, 1639, -276, 1671, -313, 1593, -313, 1022, -370, 912, -504, 868)

[node name="RecoveryTimer" type="Timer" parent="."]
wait_time = 0.2

[node name="CoinArea" type="Area2D" parent="."]
collision_layer = 4
collision_mask = 8
script = ExtResource("8_8c41q")
coin_scene = ExtResource("8_b121j")

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="CoinArea"]
position = Vector2(-3, -6)
polygon = PackedVector2Array(-653, -680, -542, -767, -429, -781, -339, -706, -280, -594, -257, -518, -216, -423, -137, -356, -147, -204, -143, 61, -135, 272, 2, 415, 204, -196, 321, -252, 445, -256, 577, -165, 669, 1392, 626, 1515, 471, 1635, 309, 1655, 195, 1301, 65, 980, 5, 992, -26, 1090, -231, 1716, -298, 1720, -350, 1624, -393, 1542, -463, 1427, -500, 1093, -600, 1030, -563, 828, -651, -591, -660, -662, -630, -655, -642, -628, -629, -582, -554, 828, -579, 1000, -537, 1032, -489, 1064, -469, 1107, -471, 1181, -471, 1307, -462, 1385, -339, 1614, -306, 1691, -277, 1709, -245, 1696, -220, 1658, -48, 1040, -7, 961, 30, 923, 74, 936, 102, 983, 131, 1036, 143, 1134, 212, 1278, 316, 1601, 366, 1614, 426, 1614, 492, 1582, 523, 1548, 536, 1504, 595, 1460, 630, 1385, 639, 1294, 571, -44, 553, -147, 485, -204, 434, -234, 325, -228, 221, -175, 153, 18, 87, 217, 53, 340, 13, 428, -62, 387, -136, 294, -154, 199, -157, -342, -222, -392, -304, -588, -354, -695, -429, -755, -537, -742, -624, -671)

[node name="CoinInstance" parent="." instance=ExtResource("8_b121j")]
position = Vector2(-639, -507)
rotation = 0.0041108127

[connection signal="body_entered" from="Circuit" to="." method="_on_circuit_body_entered"]
[connection signal="body_exited" from="FinishLineArea" to="." method="_on_finish_line_area_body_exited"]
[connection signal="body_entered" from="Crash" to="Crash" method="_on_body_entered"]
[connection signal="timeout" from="RecoveryTimer" to="." method="_on_recovery_timer_timeout"]
[connection signal="area_entered" from="CoinInstance" to="." method="_on_coin_instance_area_entered"]
